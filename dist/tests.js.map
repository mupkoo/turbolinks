{"version":3,"file":"tests.js","sources":["../src/tests/helpers/intern_test_case.ts","../src/tests/helpers/browser_test_case.ts","../src/tests/helpers/remote_channel.ts","../src/tests/helpers/turbolinks_test_case.ts","../src/tests/async_script_tests.ts","../src/tests/navigation_tests.ts","../src/tests/rendering_tests.ts","../src/tests/visit_tests.ts"],"sourcesContent":["import intern from \"intern\"\nimport { Remote } from \"intern/lib/executors/Node\"\nimport { Tests } from \"intern/lib/interfaces/object\"\n\nexport class InternTestCase {\n  readonly testName: string\n  readonly remote: Remote\n\n  static registerSuite() {\n    return intern.getInterface(\"object\").registerSuite(this.name, { tests: this.tests })\n  }\n\n  static get tests(): Tests {\n    return this.testNames.reduce((tests, testName): Tests => {\n      return { ...tests, [testName]: ({ remote }) => this.runTest(testName, remote) }\n    }, {} as Tests)\n  }\n\n  static get testNames(): string[] {\n    return this.testKeys.map(key => key.slice(5))\n  }\n\n  static get testKeys(): string[] {\n    return Object.getOwnPropertyNames(this.prototype).filter(key => key.match(/^test /))\n  }\n\n  static runTest(testName: string, remote: Remote): Promise<void> {\n    const testCase = new this(testName, remote)\n    return testCase.runTest()\n  }\n\n  constructor(testName: string, remote: Remote) {\n    this.testName = testName\n    this.remote = remote\n  }\n\n  async runTest() {\n    try {\n      await this.setup()\n      await this.beforeTest()\n      await this.test()\n      await this.afterTest()\n    } finally {\n      await this.teardown()\n    }\n  }\n\n  get assert() {\n    return intern.getPlugin(\"chai\").assert\n  }\n\n  async setup() {\n\n  }\n\n  async beforeTest() {\n\n  }\n\n  get test(): () => Promise<void> {\n    const method = (this as any)[`test ${this.testName}`]\n    if (method != null && typeof method == \"function\") {\n      return method\n    } else {\n      throw new Error(`No such test \"${this.testName}\"`)\n    }\n  }\n\n  async afterTest() {\n\n  }\n\n  async teardown() {\n\n  }\n}\n","import { InternTestCase } from \"./intern_test_case\"\nimport { Element } from \"@theintern/leadfoot\"\n\nexport class BrowserTestCase extends InternTestCase {\n  async goToLocation(location: string): Promise<void> {\n    const processedLocation = location.match(/^\\//) ? location.slice(1) : location\n    return this.remote.get(processedLocation)\n  }\n\n  async goBack(): Promise<void> {\n    return this.remote.goBack()\n  }\n\n  async goForward(): Promise<void> {\n    return this.remote.goForward()\n  }\n\n  async hasSelector(selector: string) {\n    return (await this.remote.findAllByCssSelector(selector)).length > 0\n  }\n\n  async querySelector(selector: string) {\n    return this.remote.findByCssSelector(selector)\n  }\n\n  async clickSelector(selector: string): Promise<void> {\n    return this.remote.findByCssSelector(selector).click()\n  }\n\n  get scrollPosition(): Promise<{ x: number, y: number }> {\n    return this.evaluate(() => ({ x: window.scrollX, y: window.scrollY }))\n  }\n\n  async isScrolledToSelector(selector: string): Promise<boolean> {\n    const { y: pageY } = await this.scrollPosition\n    const { y: elementY } = await this.remote.findByCssSelector(selector).getPosition()\n    const offset = pageY - elementY\n    return offset > -1 && offset < 1\n  }\n\n  async evaluate<T>(callback: () => T): Promise<T> {\n    return await this.remote.execute(callback)\n  }\n\n  get head(): Promise<Element> {\n    return this.evaluate(() => document.head as any)\n  }\n\n  get body(): Promise<Element> {\n    return this.evaluate(() => document.body as any)\n  }\n\n  get location(): Promise<string> {\n    return this.evaluate(() => location.toString())\n  }\n\n  get pathname(): Promise<string> {\n    return this.evaluate(() => location.pathname)\n  }\n\n  get hash(): Promise<string> {\n    return this.evaluate(() => location.hash)\n  }\n}\n","import { Remote } from \"intern/lib/executors/Node\"\n\nexport class RemoteChannel<T> {\n  readonly remote: Remote\n  readonly identifier: string\n  private index: number = 0\n\n  constructor(remote: Remote, identifier: string) {\n    this.remote = remote\n    this.identifier = identifier\n  }\n\n  async read(length?: number): Promise<T[]> {\n    const records = (await this.newRecords).slice(0, length)\n    this.index += records.length\n    return records\n  }\n\n  async drain(): Promise<void> {\n    await this.read()\n  }\n\n  private get newRecords() {\n    return this.remote.execute((identifier: string, index: number) => {\n      const records = (window as any)[identifier]\n      if (records != null && typeof records.slice == \"function\") {\n        return records.slice(index)\n      } else {\n        return []\n      }\n    }, [this.identifier, this.index])\n  }\n}\n","import { BrowserTestCase } from \"./browser_test_case\"\nimport { RemoteChannel } from \"./remote_channel\"\nimport { Element } from \"@theintern/leadfoot\"\n\ntype EventLog = [string, any]\n\nexport class TurbolinksTestCase extends BrowserTestCase {\n  eventLogChannel: RemoteChannel<EventLog> = new RemoteChannel(this.remote, \"eventLogs\")\n  lastBody?: Element\n\n  async beforeTest() {\n    await this.drainEventLog()\n    this.lastBody = await this.body\n  }\n\n  get nextWindowHandle(): Promise<string> {\n    return (async (nextHandle?: string) => {\n      do {\n        const handle = await this.remote.getCurrentWindowHandle()\n        const handles = await this.remote.getAllWindowHandles()\n        nextHandle = handles[handles.indexOf(handle) + 1]\n      } while (!nextHandle)\n      return nextHandle\n    })()\n  }\n\n  async nextEventNamed(eventName: string): Promise<any> {\n    let record: EventLog | undefined\n    while (!record) {\n      const records = await this.eventLogChannel.read(1)\n      record = records.find(([name]) => name == eventName)\n    }\n    return record[1]\n  }\n\n  get nextBeat(): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, 100))\n  }\n\n  get nextBody(): Promise<Element> {\n    return (async () => {\n      let body\n      do body = await this.changedBody\n      while (!body)\n      return this.lastBody = body\n    })()\n  }\n\n  get changedBody(): Promise<Element | undefined> {\n    return (async () => {\n      const body = await this.body\n      if (!this.lastBody || this.lastBody.elementId != body.elementId) {\n        return body\n      }\n    })()\n  }\n\n  get visitAction(): Promise<string> {\n    return this.evaluate(() => {\n      try {\n        return window.Turbolinks.controller.currentVisit.action\n      } catch (error) {\n        return \"load\"\n      }\n    })\n  }\n\n  drainEventLog() {\n    return this.eventLogChannel.drain()\n  }\n}\n","import { TurbolinksTestCase } from \"./helpers/turbolinks_test_case\"\n\nexport class AsyncScriptTests extends TurbolinksTestCase {\n  async setup() {\n    await this.goToLocation(\"/fixtures/async_script.html\")\n  }\n\n  async \"test does not emit turbolinks:load when loaded asynchronously after DOMContentLoaded\"() {\n    const events = await this.eventLogChannel.read()\n    this.assert.deepEqual(events, [])\n  }\n\n  async \"test following a link when loaded asynchronously after DOMContentLoaded\"() {\n    this.clickSelector(\"#async-link\")\n    await this.nextBody\n    this.assert.equal(await this.visitAction, \"advance\")\n  }\n}\n\nAsyncScriptTests.registerSuite()\n","import { TurbolinksTestCase } from \"./helpers/turbolinks_test_case\"\n\nexport class NavigationTests extends TurbolinksTestCase {\n  async setup() {\n    await this.goToLocation(\"/fixtures/navigation.html\")\n  }\n\n  async \"test after loading the page\"() {\n    this.assert.equal(await this.pathname, \"/fixtures/navigation.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test following a same-origin unannotated link\"() {\n    this.clickSelector(\"#same-origin-unannotated-link\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"advance\")\n  }\n\n  async \"test following a same-origin data-turbolinks-action=replace link\"() {\n    this.clickSelector(\"#same-origin-replace-link\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"replace\")\n  }\n\n  async \"test following a same-origin data-turbolinks=false link\"() {\n    this.clickSelector(\"#same-origin-false-link\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test following a same-origin unannotated link inside a data-turbolinks=false container\"() {\n    this.clickSelector(\"#same-origin-unannotated-link-inside-false-container\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test following a same-origin data-turbolinks=true link inside a data-turbolinks=false container\"() {\n    this.clickSelector(\"#same-origin-true-link-inside-false-container\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"advance\")\n  }\n\n  async \"test following a same-origin anchored link\"() {\n    this.clickSelector(\"#same-origin-anchored-link\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.hash, \"#element-id\")\n    this.assert.equal(await this.visitAction, \"advance\")\n    this.assert(await this.isScrolledToSelector(\"#element-id\"))\n  }\n\n  async \"test following a same-origin link to a named anchor\"() {\n    this.clickSelector(\"#same-origin-anchored-link-named\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.hash, \"#named-anchor\")\n    this.assert.equal(await this.visitAction, \"advance\")\n    this.assert(await this.isScrolledToSelector(\"[name=named-anchor]\"))\n  }\n\n  async \"test following a cross-origin unannotated link\"() {\n    this.clickSelector(\"#cross-origin-unannotated-link\")\n    await this.nextBody\n    this.assert.equal(await this.location, \"about:blank\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test following a same-origin [target] link\"() {\n    this.clickSelector(\"#same-origin-targeted-link\")\n    this.remote.switchToWindow(await this.nextWindowHandle)\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test following a same-origin [download] link\"() {\n    this.clickSelector(\"#same-origin-download-link\")\n    await this.nextBeat\n    this.assert(!await this.changedBody)\n    this.assert.equal(await this.pathname, \"/fixtures/navigation.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test following a same-origin link inside an SVG element\"() {\n    this.clickSelector(\"#same-origin-link-inside-svg-element\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"advance\")\n  }\n\n  async \"test following a cross-origin link inside an SVG element\"() {\n    this.clickSelector(\"#cross-origin-link-inside-svg-element\")\n    await this.nextBody\n    this.assert.equal(await this.location, \"about:blank\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test clicking the back button\"() {\n    this.clickSelector(\"#same-origin-unannotated-link\")\n    await this.nextBody\n    await this.goBack()\n    this.assert.equal(await this.pathname, \"/fixtures/navigation.html\")\n    this.assert.equal(await this.visitAction, \"restore\")\n  }\n\n  async \"test clicking the forward button\"() {\n    this.clickSelector(\"#same-origin-unannotated-link\")\n    await this.nextBody\n    await this.goBack()\n    await this.goForward()\n    this.assert.equal(await this.pathname, \"/fixtures/one.html\")\n    this.assert.equal(await this.visitAction, \"restore\")\n  }\n}\n\nNavigationTests.registerSuite()\n","import { TurbolinksTestCase } from \"./helpers/turbolinks_test_case\"\nimport { Element } from \"@theintern/leadfoot\"\n\nexport class RenderingTests extends TurbolinksTestCase {\n  async setup() {\n    await this.goToLocation(\"/fixtures/rendering.html\")\n  }\n\n  async \"test triggers before-render and render events\"() {\n    this.clickSelector(\"#same-origin-link\")\n    const { newBody } = await this.nextEventNamed(\"turbolinks:before-render\")\n\n    const h1 = await this.querySelector(\"h1\")\n    this.assert.equal(await h1.getVisibleText(), \"One\")\n\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert(await newBody.equals(await this.body))\n  }\n\n  async \"test triggers before-render and render events for error pages\"() {\n    this.clickSelector(\"#nonexistent-link\")\n    const { newBody } = await this.nextEventNamed(\"turbolinks:before-render\")\n\n    this.assert.equal(await newBody.getVisibleText(), \"404 Not Found: /nonexistent\")\n\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert(await newBody.equals(await this.body))\n  }\n\n  async \"test reloads when tracked elements change\"() {\n    this.clickSelector(\"#tracked-asset-change-link\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/tracked_asset_change.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test reloads when turbolinks-visit-control setting is reload\"() {\n    this.clickSelector(\"#visit-control-reload-link\")\n    await this.nextBody\n    this.assert.equal(await this.pathname, \"/fixtures/visit_control_reload.html\")\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test accumulates asset elements in head\"() {\n    const originalElements = await this.assetElements\n\n    this.clickSelector(\"#additional-assets-link\")\n    await this.nextBody\n    const newElements = await this.assetElements\n    this.assert.notDeepEqual(newElements, originalElements)\n\n    this.goBack()\n    await this.nextBody\n    const finalElements = await this.assetElements\n    this.assert.deepEqual(finalElements, newElements)\n  }\n\n  async \"test replaces provisional elements in head\"() {\n    const originalElements = await this.provisionalElements\n    this.assert(!await this.hasSelector(\"meta[name=test]\"))\n\n    this.clickSelector(\"#same-origin-link\")\n    await this.nextBody\n    const newElements = await this.provisionalElements\n    this.assert.notDeepEqual(newElements, originalElements)\n    this.assert(await this.hasSelector(\"meta[name=test]\"))\n\n    this.goBack()\n    await this.nextBody\n    const finalElements = await this.provisionalElements\n    this.assert.notDeepEqual(finalElements, newElements)\n    this.assert(!await this.hasSelector(\"meta[name=test]\"))\n  }\n\n  async \"test evaluates head script elements once\"() {\n    this.assert.equal(await this.headScriptEvaluationCount, undefined)\n\n    this.clickSelector(\"#head-script-link\")\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.headScriptEvaluationCount, 1)\n\n    this.goBack()\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.headScriptEvaluationCount, 1)\n\n    this.clickSelector(\"#head-script-link\")\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.headScriptEvaluationCount, 1)\n  }\n\n  async \"test evaluates body script elements on each render\"() {\n    this.assert.equal(await this.bodyScriptEvaluationCount, undefined)\n\n    this.clickSelector(\"#body-script-link\")\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.bodyScriptEvaluationCount, 1)\n\n    this.goBack()\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.bodyScriptEvaluationCount, 1)\n\n    this.clickSelector(\"#body-script-link\")\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.bodyScriptEvaluationCount, 2)\n  }\n\n  async \"test does not evaluate data-turbolinks-eval=false scripts\"() {\n    this.clickSelector(\"#eval-false-script-link\")\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert.equal(await this.bodyScriptEvaluationCount, undefined)\n  }\n\n  async \"test preserves permanent elements\"() {\n    let permanentElement = await this.permanentElement\n    this.assert.equal(await permanentElement.getVisibleText(), \"Rendering\")\n\n    this.clickSelector(\"#permanent-element-link\")\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert(await permanentElement.equals(await this.permanentElement))\n    this.assert.equal(await permanentElement.getVisibleText(), \"Rendering\")\n\n    this.goBack()\n    await this.nextEventNamed(\"turbolinks:render\")\n    this.assert(await permanentElement.equals(await this.permanentElement))\n  }\n\n  async \"test before-cache event\"() {\n    this.beforeCache(body => body.innerHTML = \"Modified\")\n    this.clickSelector(\"#same-origin-link\")\n    await this.nextBody\n    await this.goBack()\n    const body = await this.nextBody\n    this.assert(await body.getVisibleText(), \"Modified\")\n  }\n\n  async \"test mutation record as before-cache notification\"() {\n    this.modifyBodyAfterRemoval()\n    this.clickSelector(\"#same-origin-link\")\n    await this.nextBody\n    await this.goBack()\n    const body = await this.nextBody\n    this.assert(await body.getVisibleText(), \"Modified\")\n  }\n\n   async \"test replaces entire body when nav from normal => custom root\"() {\n    const lastBodyId = (await this.body).elementId\n\n    this.clickSelector(\"#custom-root-selector-link\")\n    await this.nextEventNamed('turbolinks:load')\n\n    const thisBodyId = (await this.body).elementId\n    this.assert.notEqual(lastBodyId, thisBodyId)\n  }\n\n  async \"test replaces entire body when nav from custom root => normal\"() {\n    await this.goToLocation(\"/fixtures/custom_root_selector.html\")\n\n    const lastBodyId = (await this.body).elementId\n\n    this.clickSelector(\"#rendering-link\")\n    await this.nextEventNamed('turbolinks:load')\n\n    const thisBodyId = (await this.body).elementId\n    this.assert.notEqual(lastBodyId, thisBodyId)\n  }\n\n   async \"test replaces only custom root with custom root specified throughout\"() {\n    await this.goToLocation(\"/fixtures/custom_root_selector.html\")\n\n    const lastBodyId  = (await this.body).elementId\n    const lastOutside = await (await this.querySelector('#rendered-by')).getVisibleText()\n    const lastInside  = await (await this.querySelector('h1')).getVisibleText()\n\n    this.clickSelector(\"#custom-root-selector-link-2\")\n    await this.nextEventNamed('turbolinks:load')\n\n    const thisBodyId  = (await this.body).elementId\n    const thisOutside = await (await this.querySelector('#rendered-by')).getVisibleText()\n    const thisInside  = await (await this.querySelector('h1')).getVisibleText()\n\n    this.assert.equal(lastBodyId, thisBodyId)\n    this.assert.notEqual(lastInside, thisInside)\n    this.assert.equal(lastOutside, thisOutside)\n  }\n\n  async \"test error pages\"() {\n    this.clickSelector(\"#nonexistent-link\")\n    const body = await this.nextBody\n    this.assert.equal(await body.getVisibleText(), \"404 Not Found: /nonexistent\")\n    await this.goBack()\n  }\n\n  get assetElements(): Promise<Element[]> {\n    return filter(this.headElements, isAssetElement)\n  }\n\n  get provisionalElements(): Promise<Element[]> {\n    return filter(this.headElements, async element => !await isAssetElement(element))\n  }\n\n  get headElements(): Promise<Element[]> {\n    return this.evaluate(() => Array.from(document.head.children) as any[])\n  }\n\n  get permanentElement(): Promise<Element> {\n    return this.querySelector(\"#permanent\")\n  }\n\n  get headScriptEvaluationCount(): Promise<number | undefined> {\n    return this.evaluate(() => window.headScriptEvaluationCount)\n  }\n\n  get bodyScriptEvaluationCount(): Promise<number | undefined> {\n    return this.evaluate(() => window.bodyScriptEvaluationCount)\n  }\n\n  async modifyBodyBeforeCaching() {\n    return this.remote.execute(() => addEventListener(\"turbolinks:before-cache\", function eventListener(event) {\n      removeEventListener(\"turbolinks:before-cache\", eventListener, false)\n      document.body.innerHTML = \"Modified\"\n    }, false))\n  }\n\n  async beforeCache(callback: (body: HTMLElement) => void) {\n    return this.remote.execute((callback: (body: HTMLElement) => void) => {\n      addEventListener(\"turbolinks:before-cache\", function eventListener(event) {\n        removeEventListener(\"turbolinks:before-cache\", eventListener, false)\n        callback(document.body)\n      }, false)\n    }, [callback])\n  }\n\n  async modifyBodyAfterRemoval() {\n    return this.remote.execute(() => {\n      const { documentElement, body } = document\n      const observer = new MutationObserver(records => {\n        for (const record of records) {\n          if (Array.from(record.removedNodes).indexOf(body) > -1) {\n            body.innerHTML = \"Modified\"\n            observer.disconnect()\n            break\n          }\n        }\n      })\n      observer.observe(documentElement, { childList: true })\n    })\n  }\n}\n\nasync function filter<T>(promisedValues: Promise<T[]>, predicate: (value: T) => Promise<boolean>): Promise<T[]> {\n  const values = await promisedValues\n  const matches = await Promise.all(values.map(value => predicate(value)))\n  return matches.reduce((result, match, index) => result.concat(match ? values[index] : []), [] as T[])\n}\n\nasync function isAssetElement(element: Element): Promise<boolean> {\n  const tagName = await element.getTagName()\n  const relValue = await element.getAttribute(\"rel\")\n  return tagName == \"script\" || tagName == \"style\" || (tagName == \"link\" && relValue == \"stylesheet\")\n}\n\ndeclare global {\n  interface Window {\n    headScriptEvaluationCount?: number\n    bodyScriptEvaluationCount?: number\n  }\n}\n\nRenderingTests.registerSuite()\n","import { TurbolinksTestCase } from \"./helpers/turbolinks_test_case\"\nimport { get } from \"http\"\n\nexport class VisitTests extends TurbolinksTestCase {\n  async setup() {\n    this.goToLocation(\"/fixtures/visit.html\")\n  }\n\n  async \"test programmatically visiting a same-origin location\"() {\n    const urlBeforeVisit = await this.location\n    await this.visitLocation(\"/fixtures/one.html\")\n\n    const urlAfterVisit = await this.location\n    this.assert.notEqual(urlBeforeVisit, urlAfterVisit)\n    this.assert.equal(await this.visitAction, \"advance\")\n\n    const { url: urlFromBeforeVisitEvent } = await this.nextEventNamed(\"turbolinks:before-visit\")\n    this.assert.equal(urlFromBeforeVisitEvent, urlAfterVisit)\n\n    const { url: urlFromVisitEvent } = await this.nextEventNamed(\"turbolinks:visit\")\n    this.assert.equal(urlFromVisitEvent, urlAfterVisit)\n\n    const { timing } = await this.nextEventNamed(\"turbolinks:load\")\n    this.assert.ok(timing)\n  }\n\n  async \"test programmatically visiting a cross-origin location falls back to window.location\"() {\n    const urlBeforeVisit = await this.location\n    await this.visitLocation(\"about:blank\")\n\n    const urlAfterVisit = await this.location\n    this.assert.notEqual(urlBeforeVisit, urlAfterVisit)\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test visiting a location served with a non-HTML content type\"() {\n    const urlBeforeVisit = await this.location\n    await this.visitLocation(\"/fixtures/svg\")\n\n    const url = await this.remote.getCurrentUrl()\n    const contentType = await contentTypeOfURL(url)\n    this.assert.equal(contentType, \"image/svg+xml\")\n\n    const urlAfterVisit = await this.location\n    this.assert.notEqual(urlBeforeVisit, urlAfterVisit)\n    this.assert.equal(await this.visitAction, \"load\")\n  }\n\n  async \"test canceling a before-visit event prevents navigation\"() {\n    this.cancelNextVisit()\n    const urlBeforeVisit = await this.location\n\n    this.clickSelector(\"#same-origin-link\")\n    await this.nextBeat\n    this.assert(!await this.changedBody)\n\n    const urlAfterVisit = await this.location\n    this.assert.equal(urlAfterVisit, urlBeforeVisit)\n  }\n\n  async \"test navigation by history is not cancelable\"() {\n    this.clickSelector(\"#same-origin-link\")\n    await this.drainEventLog()\n    await this.nextBeat\n\n    await this.goBack()\n    this.assert(await this.changedBody)\n  }\n\n  async visitLocation(location: string) {\n    this.remote.execute((location: string) => window.Turbolinks.visit(location), [location])\n  }\n\n  async cancelNextVisit() {\n    this.remote.execute(() => addEventListener(\"turbolinks:before-visit\", function eventListener(event) {\n      removeEventListener(\"turbolinks:before-visit\", eventListener, false)\n      event.preventDefault()\n    }, false))\n  }\n}\n\nfunction contentTypeOfURL(url: string): Promise<string | undefined> {\n  return new Promise(resolve => {\n    get(url, ({ headers }) => resolve(headers[\"content-type\"]))\n  })\n}\n\nVisitTests.registerSuite()\n"],"names":["tslib_1.__extends","get"],"mappings":"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"}